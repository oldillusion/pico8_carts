pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
	icrops()
	iplr()
	iinv()
end

function _update()
 ucrops()
 uplr()
 uinv()
end

function _draw()
	cls(11)
	map()
	dcrops()
	dplr()
	dinv()
end
-->8
--player--

function iplr()
	plr={
		x=63,
		y=63
	}
end

function uplr()
	-- movement
	if btn(➡️) then
		plr.x+=1
	elseif btn(⬅️) then
		plr.x-=1
	elseif btn(⬆️) then
		plr.y-=1
	elseif btn(⬇️) then
		plr.y+=1
	end
	-- plant
	local ptx=flr((plr.x+4)/8)
	local pty=flr((plr.y+6)/8)
	if btnp(❎) then
	 if fget(mget(ptx,pty),1) and seed_count>0 then
	 	mset(ptx,pty,3)
		 add(patches,{
		  sx=ptx,
		  sy=pty,
		  watered=false,
		  tig=0 --time in ground
		 })
		 seed_count-=1
		elseif mget(ptx,pty)==3 then
			mset(ptx,pty,5)
			for p in all(patches) do
				if p.sx==ptx and p.sy==pty then
					p.watered=true
				end
			end
		elseif fget(mget(ptx,pty),2) then
			for p in all(patches) do
				if p.sx==ptx and p.sy==pty then
					del(patches,p)
				end
			end
			mset(ptx,pty,0)
			harvest()
		end
	end
end

function dplr()
	spr(12,plr.x,plr.y)
end
-->8
-- nature's way

function icrops()
	croptimer=60
	patches={}
end

function ucrops()
	for p in all(patches) do
		if p.watered then
			if p.tig>=0 and p.tig<croptimer then
				p.tig+=1
			end
			if p.tig==croptimer then
				p.tig=-1
				mset(p.sx,p.sy,4)
			end
		end
	end
end

function dcrops()
 -- print(croptimer)
end

-->8
--inventory

function iinv()
	inv={}
	seed_count=9
	carrot_count=0
end

function uinv()

end

function dinv()
	spr(19,84,2)
	print(seed_count,94,4,7)
	spr(18,104,2)
	print(carrot_count,114,4,7)
end

function harvest()
	--add(inv,18)
	carrot_count+=1
	seed_count+=flr(rnd(3))
end
__gfx__
00000000000000000444444004444440044444400444444000000000000000000000000000000000000000000000000000c70000000000000000000000000000
00000000000003304424424444244244444b4b44442dd2440000000000000000000000000000000000000000000000000cccc000000000000000000000000000
00700700000030004444444444444a444444b4444ddddad400000000000000000000000000000000000000000000000007cc7000000000000000000000000000
00077000030030004444244444a42444444999444dad2dd4000000000000000000000000000000000000000000000000dd776600000000000000000000000000
000770000300300042444424424444244429992442dddd240000000000000000000000000000000000000000000000000dd66000000000000000000000000000
007007000030000044444444444444a4444222444ddddda40000000000000000000000000000000000000000000000000dd66000000000000000000000000000
000000000030000044442444444a24444444444444da2d4400000000000000000000000000000000000000000000000000aa0000000000000000000000000000
00000000003000000444444004444440044444400444444000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000001000000111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000001b100001656510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000001bb10000166aaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000001bb99100016aaba1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000119991001aa9aa1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000001999101797761000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000199101777661000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000011100111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0202000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000010000000001000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000010000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000010000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
